{"version":3,"sources":["../../src/FileSaver.js","views/extensions/import-export/Export.js","@core/components/extensions-header/index.js"],"names":["b","a","autoBom","console","warn","test","type","Blob","c","d","XMLHttpRequest","open","responseType","onload","g","response","onerror","error","send","status","e","dispatchEvent","MouseEvent","document","createEvent","initMouseEvent","window","f","self","global","navigator","userAgent","saveAs","HTMLAnchorElement","prototype","h","i","URL","webkitURL","j","createElement","name","download","rel","href","origin","location","target","createObjectURL","setTimeout","revokeObjectURL","msSaveOrOpenBlob","title","body","innerText","HTMLElement","safari","FileReader","k","onloadend","result","replace","readAsDataURL","l","m","module","exports","initialData","id","username","email","website","Export","tableRef","useRef","_useState","useState","data","_slicedToArray","_useState3","_useState4","value","setValue","_useState5","_useState6","modal","setModal","_useState7","_useState8","fileName","setFileName","_useState9","_useState10","filteredData","setFilteredData","_useState11","_useState12","fileFormat","setFileFormat","toggleModal","renderTableData","map","col","_jsxs","children","_jsx","Fragment","ExtensionsHeader","subTitle","link","Row","className","Col","sm","Card","CardBody","Button","color","onClick","Label","for","Input","bsSize","onChange","dataArr","length","filter","startsWithCondition","toLowerCase","startsWith","toString","includesCondition","includes","handleFilter","Table","innerRef","responsive","Modal","isOpen","toggle","onClosed","ModalHeader","ModalBody","placeholder","ModalFooter","bookType","wb","XLSX","utils","table_to_book","current","sheet","wbout","write","bookSST","file","concat","FileSaver","s","buf","ArrayBuffer","view","Uint8Array","charCodeAt","s2ab","handleExport","props"],"mappings":"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","file":"static/js/60.fed5f95b.chunk.js","sourcesContent":["/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n","// ** React Imports\r\nimport { Fragment, useState, useRef } from 'react'\r\n\r\n// ** Custom Components\r\nimport ExtensionsHeader from '@components/extensions-header'\r\n\r\n// ** Third Party Components\r\nimport XLSX from 'xlsx'\r\nimport * as FileSaver from 'file-saver'\r\n\r\n// ** Reactstrap Imports\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  Table,\r\n  Modal,\r\n  Input,\r\n  Label,\r\n  Button,\r\n  CardBody,\r\n  ModalBody,\r\n  ModalHeader,\r\n  ModalFooter\r\n} from 'reactstrap'\r\n\r\nconst initialData = [\r\n  {\r\n    id: 1,\r\n    name: 'Leanne Graham',\r\n    username: 'Bret',\r\n    email: 'Sincere@april.biz',\r\n    website: 'hildegard.org'\r\n  },\r\n  {\r\n    id: 2,\r\n    name: 'Ervin Howell',\r\n    username: 'Antonette',\r\n    email: 'Shanna@melissa.tv',\r\n    website: 'anastasia.net'\r\n  },\r\n  {\r\n    id: 3,\r\n    name: 'Clementine Bauch',\r\n    username: 'Samantha',\r\n    email: 'Nathan@yesenia.net',\r\n    website: 'ramiro.info'\r\n  },\r\n  {\r\n    id: 4,\r\n    name: 'Patricia Lebsack',\r\n    username: 'Karianne',\r\n    email: 'Julianne.OConner@kory.org',\r\n    website: 'kale.biz'\r\n  },\r\n  {\r\n    id: 5,\r\n    name: 'Chelsey Dietrich',\r\n    username: 'Kamren',\r\n    email: 'Lucio_Hettinger@annie.ca',\r\n    website: 'demarco.info'\r\n  },\r\n  {\r\n    id: 6,\r\n    name: 'Mrs. Dennis Schulist',\r\n    username: 'Leopoldo_Corkery',\r\n    email: 'Karley_Dach@jasper.info',\r\n    website: 'ola.org'\r\n  },\r\n  {\r\n    id: 7,\r\n    name: 'Kurtis Weissnat',\r\n    username: 'Elwyn.Skiles',\r\n    email: 'Telly.Hoeger@billy.biz',\r\n    website: 'elvis.io'\r\n  },\r\n  {\r\n    id: 8,\r\n    name: 'Nicholas Runolfsdottir V',\r\n    username: 'Maxime_Nienow',\r\n    email: 'Sherwood@rosamond.me',\r\n    website: 'jacynthe.com'\r\n  },\r\n  {\r\n    id: 9,\r\n    name: 'Glenna Reichert',\r\n    username: 'Delphine',\r\n    email: 'Chaim_McDermott@dana.io',\r\n    website: 'conrad.com'\r\n  },\r\n  {\r\n    id: 10,\r\n    name: 'Clementina DuBuque',\r\n    username: 'Moriah.Stanton',\r\n    email: 'Rey.Padberg@karina.biz',\r\n    website: 'ambrose.net'\r\n  }\r\n]\r\n\r\nconst Export = () => {\r\n  // ** Ref\r\n  const tableRef = useRef()\r\n\r\n  // ** States\r\n  const [data] = useState(initialData)\r\n  const [value, setValue] = useState('')\r\n  const [modal, setModal] = useState(false)\r\n  const [fileName, setFileName] = useState('')\r\n  const [filteredData, setFilteredData] = useState([])\r\n  const [fileFormat, setFileFormat] = useState('xlsx')\r\n\r\n  const toggleModal = () => {\r\n    setModal(!modal)\r\n  }\r\n\r\n  const handleFilter = e => {\r\n    const dataArr = data\r\n    let filteredData = []\r\n    const value = e.target.value\r\n    setValue(value)\r\n    if (value.length) {\r\n      filteredData = dataArr.filter(col => {\r\n        const startsWithCondition =\r\n          col.name.toLowerCase().startsWith(value.toLowerCase()) ||\r\n          col.email.toLowerCase().startsWith(value.toLowerCase()) ||\r\n          col.website.toLowerCase().startsWith(value.toLowerCase()) ||\r\n          col.id.toString().toLowerCase().startsWith(value.toLowerCase())\r\n\r\n        const includesCondition =\r\n          col.name.toLowerCase().includes(value.toLowerCase()) ||\r\n          col.email.toLowerCase().includes(value.toLowerCase()) ||\r\n          col.website.toLowerCase().includes(value.toLowerCase()) ||\r\n          col.id.toString().toLowerCase().includes(value.toLowerCase())\r\n\r\n        if (startsWithCondition) return startsWithCondition\r\n        else if (!startsWithCondition && includesCondition) return includesCondition\r\n        else return null\r\n      })\r\n      setFilteredData(filteredData)\r\n      setValue(value)\r\n    }\r\n  }\r\n\r\n  const handleExport = () => {\r\n    toggleModal()\r\n    const bookType = fileFormat\r\n    const wb = XLSX.utils.table_to_book(tableRef.current, { sheet: 'Sheet JS' })\r\n    const wbout = XLSX.write(wb, { bookType, bookSST: true, type: 'binary' })\r\n\r\n    const s2ab = s => {\r\n      const buf = new ArrayBuffer(s.length)\r\n      const view = new Uint8Array(buf)\r\n      for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xff\r\n      return buf\r\n    }\r\n    const file = fileName.length ? `${fileName}.${fileFormat}` : `excel-sheet.${fileFormat}`\r\n\r\n    return FileSaver.saveAs(new Blob([s2ab(wbout)], { type: 'application/octet-stream' }), file)\r\n  }\r\n\r\n  const array = value ? filteredData : data\r\n  const renderTableData = array.map(col => {\r\n    return (\r\n      <tr key={col.id}>\r\n        <td>{col.email}</td>\r\n        <td>{col.name}</td>\r\n        <td>{col.website}</td>\r\n        <td>{col.id}</td>\r\n      </tr>\r\n    )\r\n  })\r\n  return (\r\n    <Fragment>\r\n      <ExtensionsHeader\r\n        title='XLSX'\r\n        subTitle='Xlsx is a parser and writer for various spreadsheet formats'\r\n        link='https://github.com/SheetJS/sheetjs'\r\n      />\r\n      <Row className='export-component'>\r\n        <Col sm='12'>\r\n          <Card>\r\n            <CardBody className='pb-0'>\r\n              <div className='d-flex justify-content-between flex-wrap flex-sm-row flex-column'>\r\n                <Button color='primary' onClick={() => toggleModal()}>\r\n                  Export\r\n                </Button>\r\n                <div className='d-flex align-items-center justify-content-end mt-sm-0 mt-1'>\r\n                  <Label for='search-input' className='me-1'>\r\n                    Search\r\n                  </Label>\r\n                  <Input id='search-input' bsSize='sm' type='text' value={value} onChange={e => handleFilter(e)} />\r\n                </div>\r\n              </div>\r\n            </CardBody>\r\n            <Table innerRef={tableRef} className='table-hover-animation mt-2' responsive>\r\n              <thead>\r\n                <tr>\r\n                  <th>Email</th>\r\n                  <th>Name</th>\r\n                  <th>Website</th>\r\n                  <th>Rank</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>{renderTableData}</tbody>\r\n            </Table>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n      <Modal\r\n        isOpen={modal}\r\n        toggle={() => toggleModal()}\r\n        className='modal-dialog-centered'\r\n        onClosed={() => setFileName('')}\r\n      >\r\n        <ModalHeader toggle={() => toggleModal()}>Export To Excel</ModalHeader>\r\n        <ModalBody>\r\n          <div className='mb-2'>\r\n            <Input\r\n              type='text'\r\n              value={fileName}\r\n              onChange={e => setFileName(e.target.value)}\r\n              placeholder='Enter File Name'\r\n            />\r\n          </div>\r\n          <div>\r\n            <Input\r\n              type='select'\r\n              id='selectFileFormat'\r\n              name='customSelect'\r\n              value={fileFormat}\r\n              onChange={e => setFileFormat(e.target.value)}\r\n            >\r\n              <option>xlsx</option>\r\n              <option>csv</option>\r\n              <option>txt</option>\r\n            </Input>\r\n          </div>\r\n        </ModalBody>\r\n        <ModalFooter>\r\n          <Button color='primary' onClick={() => handleExport()}>\r\n            Export\r\n          </Button>\r\n          <Button color='flat-danger' onClick={() => toggleModal()}>\r\n            Cancel\r\n          </Button>\r\n        </ModalFooter>\r\n      </Modal>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default Export\r\n","// ** React Imports\r\nimport Proptypes from 'prop-types'\r\n\r\n// ** Reactstrap Imports\r\nimport { Row, Col } from 'reactstrap'\r\n\r\nconst ExtensionsHeader = props => {\r\n  return (\r\n    <Row className='mb-2'>\r\n      <Col sm='12' className='ms-50'>\r\n        <p className='font-medium-5 mt-1 extension-title' data-tour='extension-title'>\r\n          {props.title}\r\n        </p>\r\n        {props.link ? (\r\n          <a href={props.link} target='_blank' rel='noopener noreferrer'>\r\n            {props.subTitle}\r\n          </a>\r\n        ) : (\r\n          <p className='text-primary'>{props.subTitle}</p>\r\n        )}\r\n      </Col>\r\n    </Row>\r\n  )\r\n}\r\nexport default ExtensionsHeader\r\n\r\n// ** PropTypes\r\nExtensionsHeader.propTypes = {\r\n  link: Proptypes.string,\r\n  title: Proptypes.string.isRequired,\r\n  subTitle: Proptypes.string.isRequired\r\n}\r\n"],"sourceRoot":""}